{% extends 'base.html.twig' %}

{% block title %}Page Profil{% endblock %}

{% block body %}

<p class="ml-3 ml-md-5">
    <a href="{{path('home')}}" class="btn btn-dark ml-lg-4">
        <i class="fas fa-arrow-circle-left"></i>
        Retour
    </a>
</p>

<div class="col-12 ">

    <div class="row col-12 col-md-11 mx-auto p-lg-0 d-flex justify-content-between">

        <div class="col-12 col-lg-11 p-0">

            <div class="card">

                <div class="card d-flex flex-row flex-wrap justify-content-around">{# Carte de visite #}

                    <div class="d-flex flex-column">{# picture & boutons modif#}
                        <div class="p-2">
                            <img src="{{ asset('uploads/images/'~ (candidateDatas.picture ?:'default-candidate.png')) }}"
                                style="width: 100px;height:100px;" class="mb-2 rounded-circle" />
                        </div>

                        <div class="p-2">

                            <a href= "{{ path("candidate_picture_edit", {"id": candidateDatas.id }) }}">
                                <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                            </a>
                            <a href= "{{ path("candidate_picture_delete", {"id": candidateDatas.id }) }}">
                                <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                            </a>

                        </div>
                    </div>{# fin picture & boutons modif#}


                    <div class="d-flex flex-column ">{# nom prénon mail phone number & boutons modif#}

                        <div class="p-2 table-responsive">
                            
                            <table class="table">
                                <thead>{# titre de colonnes #}
                                    <tr>          
                                        <th scope="col" class="font-weight-bold h5">
                                        Informations Personnelles
                                            <a href= "{{ path("candidate_informations", {"id": app.user.id }) }}">
                                                <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                            </a>
                                        </th>
                    
                                    </tr>
                                </thead>{# fin titre de colonnes #}
                                <tbody>
                                    <tr>
                                        <th>{{ app.user.lastname }} {{ app.user.firstname }}
                                        </th>
                                        </tr>
                                    <tr>
                                        <td>{{ app.user.email }}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <table class="table">
                                <thead>{# titre de colonnes #}
                                    <tr>          
                                        <th scope="col" class="font-weight-bold h5">
                                        Carte de visite
                                            <a href= "{{ path("presentation_edit", {"id": candidateDatas.id }) }}">
                                                <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                            </a>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>                              
                                    <tr>
                                        <td>
                                            <span class="font-weight-bold">téléphone:</span>
                                            {{ candidateDatas.phoneNumber }}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span class="font-weight-bold">Visible par les recruteurs:</span>
                                                {% if candidateInformation.visibilityChoice == 0 %}
                                                    Nom et prénom
                                                {% elseif candidateInformation.visibilityChoice == 2 %}
                                                    Prénom uniquement
                                                {% else %}
                                                    Nom uniquement
                                                {% endif %}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                                                       
                        </div>


                    </div> {# fin nom prénon mail phone number & boutons modif#}


                    

                        <div class="d-flex flex-column"> {# site web, statut recherche ou adopté & mobilities & boutons #}
                            <div class="p-2 table-responsive">
                                <table class="table">
                                    <tbody>
                                        <tr>
                                            <th>Site:
                                                <a href="{{webSite.link}}"> {{webSite.name}}</a>
                                            </th>
                                            <td>
                                                <a href= "{{ path("website_edit", {"id": webSite.id }) }}">
                                                     <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                                </a>
                                                <a href= "{{ path("website_delete", {"id": webSite.id }) }}">
                                                    <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                                                </a>
                                            </td>
                                        </tr>

                                        <tr>
                                            {% if candidateInformation.adopted == 1 %}
                                                <th class="text-success">
                                                    Adopté
                                            {% else %}
                                                <th class="text-danger"> En recherche d'alternance
                                            {% endif %}
                                                </th>
                                                <td>                                   
                                                    <a href= "{{ path("presentation_edit", {"id": visitCardId }) }}">
                                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                                    </a>
                                                    <a href= "{{ path("presentation_delete", {"id": visitCardId }) }}">
                                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                                                    </a>
                                                </td>
                                        </tr>

                                        
                                        {% if candidateInformation.adopted == 1 %}
                                        <tr> <th></th></tr>
                                                    
                                        {% else %}
                                        <tr>
                                            <th class="text-secondary font-italic"> Aux alentours de:
                                            </th>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>
                                                {% for mobilityInfo in mobilitiesInfo %}
                                                    <p>{{mobilityInfo.townName}}, {{mobilityInfo.department.name}} </p>
                                                {% endfor %}
                                            </td> 
                                                                                         
                                            <td>
                                                {% for mobilityInfo in mobilitiesInfo %}
                                                    <p>
                                                        <a href= "{{ path("mobility_edit", {"id": mobilityInfo.id }) }}">
                                                            <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                                        </a>
                                                        <a href= "{{ path("mobility_delete", {"id": mobilityInfo.id }) }}">
                                                            <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                                                        </a>
                                                    </p>
                                                {% endfor %}
                                            </td>                                                       
                                        </tr>
                                        <tr>
                                        
                                            <td>
                                            Ajouter une localité
                                            </td>
        
                                            <td>
                                                <p>
                                                    <a href= "{{ path("mobility_add")}}">
                                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-plus-square"></i></button>
                                                    </a>
                                                </p>
                                            
                                            </td>
                                        </tr>
                                            
                                        {% endif %}
                                    </tbody>
                                </table>

                                
                            </div>


                            
                            
                        </div> {# fin site web, statut recherche ou adopté &mobilities & boutons modif#}



                </div> {# Fin carte visite #}

                <div class="card accordion col-12 col-lg-12 p-0 " id="accordionExample"> {# Accordéon il m'ont vu #} {# Carte Ils ont vu votre prolfil #}
                     
                
                    <div class="card-header col-12 h5 mb-0 text-white text-center profil" id="headingOne" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        Ils ont vu votre profil!
                    </div>
            
                    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
                        <div class="card-body d-md-flex flex-row flex-wrap justify-content-around">
                            {% for viewInfo in viewsInfo %}
                                <h3><span class="badge badge-pill badge-warning">{{ viewInfo.companyName}}</span></h3>                         
                            {% endfor %}
                        </div>
                    </div>
                
                   
                </div>{# fin accordéon #} {# fin Carte Ils ont vu votre prolfil #}

                <div class="card"> {# Carte About #}
                        <div class="card-header">
                                <h2 class="h5 mb-0 text-center text-secondary">
                                    A propos de moi
                                    <a href= "{{ path("presentation_edit", {"id": visitCardId }) }}">
                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                    </a>
                                    <a href= "{{ path("presentation_delete", {"id": visitCardId }) }}">
                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                                    </a>
                                </h2>
                        </div>
                        <div class="card-body">
                            <p class="text-justify">
                                {{ candidateInformation.about}}
                            </p>
                        </div>
                        
                </div> {# Fin carte About #}


                {% for formationInfo in formationsInfo %}  {# Carte Alternace recherchée n'apparait que s'il y a une formation avec le statut 2 Pas de bouton add car 1 seul alternance possible à la fois#}                                    
                    {% if formationInfo.status == 2 %}
                        <div class="card"> {# Carte Alternace recherchée #}
                            <div class="card-header">
                                <h2 class="h5 mb-0 text-center text-secondary">
                                    Alternance recherchée
                                    <a href= "{{ path("formation_edit", {"id": formationInfo.id }) }}">
                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                    </a>
                                    <a href= "{{ path("formation_delete", {"id": formationInfo.id }) }}">
                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                                    </a>
                                </h2>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                     <table class="table">
                                        <tbody>
                                        <tr>
                                            <th scope="row">A partir du </th> 
                                            <td>{{ formationInfo.startedAt|date("m/d/Y")}}</td>                                                      
                                        </tr>
                                        <tr>
                                            <th scope="row">Jusqu'au </th> 
                                            <td>{{ formationInfo.endedAt|date("m/d/Y")}}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Avec l'école</th> 
                                            <td>{{ formationInfo.school.name}}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Pour obtenir le diplôme</th> 
                                            <td>{{ formationInfo.awardName}}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">De niveau</th> 
                                            <td>{{ formationInfo.awardLevel.name}}</td>
                                        </tr>                                           
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div> {# Fin carte Alternance recherchée #}
                    {% endif %}
               {% endfor %}{# FIN Carte Alternace recherchée n'apparait que s'il y a une formation avec le statut 2#}

                    <div class="card"> {# Carte formation Si pas de formation trouvée se trouve juste le boutons ajouter une formation#}
                        <div class="card-header">
                            <h2 class="h5 mb-0 text-center text-secondary">
                                Formations
                            </h2>
                        </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>{# titre de colonnes #}
                                            <tr>
                                                <th scope="col" class="text-info">
                                                    <a href= "{{ path("formation_add") }}">
                                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-plus"></i></button>
                                                    </a>
                                                Ajouter une formation</th>
                                                    
                                            </tr>
                                        </thead>{# fin titre de colonnes #}
                                    </table>
                                </div>
                            {% for formationInfo in formationsInfo %}
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>{# titre de colonnes #}
                                            <tr>
                                                <th scope="col" class="text-info">
                                                    <a href= "{{ path("formation_edit", {"id": formationInfo.id }) }}">
                                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                                    </a>
                                                    <a href= "{{ path("formation_delete", {"id": formationInfo.id }) }}">
                                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                                                    </a>
                                                {{ formationInfo.awardName}}</th>
                                                    
                                            </tr>
                                        </thead>{# fin titre de colonnes #}
                                        <tbody>
                                            <tr>{#Niveau du diplôme#}
                                                <th scope="row">Niveau scolaire
                                                </th>
                                            </tr>
                                            <tr>                                                    
                                                <td>{{ formationInfo.awardLevel.name}}
                                                </td>                                                       
                                            </tr>
                                            <tr> {#Nom de l'école#}
                                                <th scope="row">Ecole
                                                </th>
                                            </tr>
                                            <tr>                                          
                                                <td>{{ formationInfo.school.name}}
                                                </td>                                                                         
                                            </tr>
                                            <tr>{#Date obtention diplôme OU formation toujours en cours#}
                                                <th scope="row">Date d'obtention du diplôme
                                                </th>
                                            </tr>
                                            <tr>                                          
                                                {% if formationInfo.status == 0 %}
                                                <td>{{ formationInfo.obtainedAt|date("m/d/Y")}}</td>
                                                {% elseif formationInfo.status == 1 %}
                                                <td>en cours</td>
                                                {% elseif formationInfo.status == 2 %}
                                                <td>en cours et en recherche d'alternance</td>
                                                {% endif %}
                                            </tr>
                                        </tbody>
                                    </table>
                                
                                </div>
                            {% endfor %}
                            </div>

                    </div> {# Fin carte formation #}

                    <div class="card"> {# Carte expériences #}
                        <div class="card-header">
                            <h2 class="h5 mb-0 text-center text-secondary">
                                Expériences
                            </h2>
                        </div>
                            <div class="card-body">

                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>{# titre de colonnes #}
                                            <tr>
                                                <th scope="col" class="text-info">
                                                    <a href= "{{ path("experience_add") }}">
                                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-plus"></i></button>
                                                    </a>
                                                Ajouter une expérience</th>                                          
                                            </tr>
                                        </thead>{# fin titre de colonnes #}
                                    </table>
                                </div>
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>{# titre de colonnes #}
                                            <tr>
                                              <th scope="col">Période</th>
                                              <th scope="col">Entreprise</th>
                                              <th scope="col">Description</th>
                                              <th scope="col"></th>
                                            </tr>
                                        </thead>{# fin titre de colonnes #}
                                        <tbody>{# corps tableau exp #}
                                          
                                            {% for experienceInfo in experiencesInfo %}
                                            <tr>
                                                <td>
                                                Du {{ experienceInfo.startedAt|date("m/d/Y")}}
                                                {% if experienceInfo.endedAt == null %}
                                                à aujourd'hui
                                                
                                                {% else %}
                                                à {{ experienceInfo.endedAt|date("m/d/Y")}}
                                                {% endif %}
            
                                                </td>
                                                <td>{{ experienceInfo.companyName}}</td>
                                                <td>{{ experienceInfo.description}}</td>
                                               
                                                <td>
                                                    <a href= "{{ path("experience_edit", {"id": experienceInfo.id }) }}">
                                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                                    </a>
                                                    <a href= "{{ path("experience_delete", {"id": experienceInfo.id }) }}">
                                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                                                    </a>
                                                </td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>{# fin corps tableau exp #}

                                    </table>
                                </div>
                            </div>

                    </div> {# Fin carte Formation #}

                    <div class="card"> {# Carte compétences #}
                        <div class="card-header">
                            <h2 class="h5 mb-0 text-center text-secondary">
                                Compétences
                            </h2>
                        </div>

                        <div class="card-body">
                            <div class="table-responsive">
                                    <table class="table">
                                        <thead>{# titre de colonnes #}
                                            <tr>
                                                <th scope="col" class="text-info">
                                                    <a href= "{{ path("experience_add") }}">
                                                        <button class="btn btn-light " id="" type="button"> <i class="fas fa-plus"></i></button>
                                                    </a>
                                                Ajouter une compétence</th>                                          
                                            </tr>
                                        </thead>{# fin titre de colonnes #}
                                    </table>
                                </div>
                            <div class="table-responsive">
                                <table class="table">
                                    
                                    {% for skillInfo in skillsInfo %}
                                    <tr>
                                        <td>
                                        {{skillInfo.name}}
                                        </td>
                                        <td>
                                            <a href= "{{ path("skill_edit", {"id": skillInfo.id }) }}">
                                                <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                            </a>
                                            <a href= "{{ path("skill_delete", {"id": skillInfo.id }) }}">
                                                <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                                            </a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                
                                </table>
                            </div>
                        </div>                        

                    </div> {# Fin carte compétences #}

                    <div class="card"> {# carte Atouts et centres d'intérêts #}
                        <div class="card-header">
                            <h2 class="h5 mb-0 text-center text-secondary">
                                Atouts et centres d'intérêts
                            </h2>
                        </div>
                        <div class="card-body">

                            <div class="table-responsive">
                                <table class="table">
                                    <thead>{# titre de colonnes #}
                                        <tr>
                                          <th scope="col" class="text-info">
                                                <a href= "{{ path("asset_add") }}">
                                                    <button class="btn btn-light " id="" type="button"> <i class="fas fa-plus"></i></button>
                                                </a>
                                          Ajouter un atout ou un centre d'intérêt</th>
                                        </tr>
                                    </thead>{# fin titre de colonnes #}
                                </table>
                            </div>
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>{# titre de colonnes #}
                                        <tr>
                                          <th scope="col">Atouts</th>
                                          <th></th>
                                        </tr>
                                    </thead>{# fin titre de colonnes #}

                                    <tbody>{# corps tableau atouts#}
                                    {% for additionalInfo in additionalsInfo %}
                                        <tr>
                                        {% if additionalInfo.typeInfo == 'assert' %}
                                            <td>
                                            {{additionalInfo.content}}
                                            </td>
                                            <td>
                                                <a href= "{{ path("asset_edit", {"id": additionalInfo.id }) }}">
                                                    <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                                </a>
                                                <a href= "{{ path("asset_delete", {"id": additionalInfo.id }) }}">
                                                    <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                                                </a>
                                            </td>          
                                        {% else %}
                                        {% endif %}
                                        
                                    {% endfor %}

                                    <thead>{# titre de colonnes #}
                                        <tr>
                                          <th scope="col">Centres d'intérêts</th>
                                          <th></th>
                                        </tr>
                                    </thead>{# fin titre de colonnes #}

                                    <tbody>{# corps tableau centres d'intérêts#}
                                    {% for additionalInfo in additionalsInfo %}
                                        <tr>
                                        {% if additionalInfo.typeInfo == 'interest' %}
                                            <td>
                                            {{additionalInfo.content}}
                                            </td>
                                            <td>
                                                <a href= "{{ path("asset_edit", {"id": additionalInfo.id }) }}">
                                                    <button class="btn btn-light " id="" type="button"> <i class="fas fa-edit"></i></button>
                                                </a>
                                                <a href= "{{ path("asset_delete", {"id": additionalInfo.id }) }}">
                                                    <button class="btn btn-light " id="" type="button"> <i class="fas fa-window-close"></i></button>
                                                </a>
                                            </td>          
                                        {% else %}
                                        {% endif %}
                                        
                                    {% endfor %}

                                </table>
                            </div>
                        </div>            

                    </div> {# Fin carte Savoirs-faire et centres d'intérêts #}

                </div>


                {# Lien retour #}
                <p>
                    <a href="{{path('home')}}" class="btn btn-dark">
                        <i class="fas fa-arrow-circle-left"></i>
                        Retour
                    </a>
                </p>
            </div>


        </div>

    </div>

</div>


    {% endblock %}